# Cross C2

[README](README.md) | [ä¸­æ–‡æ–‡æ¡£](README_zh.md)

ğŸš€ æ›´å¿«æ·çš„ç”Ÿæˆæ–¹å¼ï¼Œå‚è§ **cna** ä»‹ç» [GOğŸ“Œ](#cnaæ’ä»¶æ–¹å¼)

ğŸ‰ **Android** & **iPhone** æ”¯æŒ [GOğŸ“Œ](#Mobile)

# Cross C2 - ç”ŸæˆCobaltStrikeçš„è·¨å¹³å°beacon

```
     â–„â–ˆâ–ˆâ–ˆâ–ˆâ–„   â–ˆâ–ˆâ–€â–ˆâ–ˆâ–ˆ   â–’â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     â–„â–ˆâ–ˆâ–ˆâ–ˆâ–„   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–„ 
    â–’â–ˆâ–ˆâ–€ â–€â–ˆ  â–“â–ˆâ–ˆ â–’ â–ˆâ–ˆâ–’â–’â–ˆâ–ˆâ–’  â–ˆâ–ˆâ–’â–’â–ˆâ–ˆ    â–’ â–’â–ˆâ–ˆ    â–’    â–’â–ˆâ–ˆâ–€ â–€â–ˆ        â–ˆâ–ˆâ–‘
    â–’â–“â–ˆ    â–„ â–“â–ˆâ–ˆ â–‘â–„â–ˆ â–’â–’â–ˆâ–ˆâ–‘  â–ˆâ–ˆâ–’â–‘ â–“â–ˆâ–ˆâ–„   â–‘ â–“â–ˆâ–ˆâ–„      â–’â–“â–ˆ        â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–’ 
    â–’â–“â–“â–„ â–„â–ˆâ–ˆâ–’â–’â–ˆâ–ˆâ–€â–€â–ˆâ–„  â–’â–ˆâ–ˆ   â–ˆâ–ˆâ–‘  â–’   â–ˆâ–ˆâ–’  â–’   â–ˆâ–ˆâ–’   â–’â–“â–“â–„ â–„â–ˆ â–‘â–’â–ˆâ–ˆ      
    â–’ â–“â–ˆâ–ˆâ–ˆâ–€ â–‘â–‘â–ˆâ–ˆâ–“ â–’â–ˆâ–ˆâ–’â–‘ â–ˆâ–ˆâ–ˆâ–ˆâ–“â–’â–‘â–’â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–’â–’â–’â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–’â–’   â–’ â–“â–ˆâ–ˆâ–ˆâ–€  â–‘â–’â–“â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–“
    â–‘ â–‘â–’ â–’  â–‘â–‘ â–’â–“ â–‘â–’â–“â–‘â–‘ â–’â–‘â–’â–‘â–’â–‘ â–’ â–’â–“â–’ â–’ â–‘â–’ â–’â–“â–’ â–’ â–‘   â–‘ â–‘â–’ â–’    â–‘â–’ â–‘â–“ â–‘â–‘
      â–‘  â–’     â–‘â–’ â–‘ â–’â–‘  â–‘ â–’ â–’â–‘ â–‘ â–‘â–’  â–‘ â–‘â–‘ â–‘â–’  â–‘ â–‘     â–‘  â–’     â–‘ â–‘â–‘ â–‘ 
    â–‘          â–‘â–‘   â–‘ â–‘ â–‘ â–‘ â–’  â–‘  â–‘  â–‘  â–‘  â–‘  â–‘     â–‘         by:â–‘hook
    â–‘ â–‘         â–‘         â–‘ â–‘        â–‘        â–‘     â–‘ â–‘          â–‘    
    â–‘                                               â–‘                 
              
```

![](media/15794884596715/15794993795360.jpg)
![](media/15848885324084/15848892759774.jpg)


# Description

ä¸ºCobaltStrikeæ·»åŠ å…¶ä»–å¹³å°çš„beaconç”ŸæˆåŠŸèƒ½ï¼Œæš‚æ—¶ä»…æ”¯æŒåœ¨ **Linux** & **MacOS** ä¸Šè¿è¡Œã€‚


|  | Windows | Linux | MacOS | iOS | Android | Embedded |
| --- | --- | --- | --- | --- | --- | --- |
| Run Env (x86) |  | âˆš |  |  |  |  |
| Run Env (x64) |  | âˆš | âˆš |  |  |  |
| gen beacon (x86) |  | âˆš |  |  | âˆš |  |
| gen beacon (x64) |  | âˆš | âˆš |  |  |  |
| gen beacon (armv7) |  |  |  | â»  | âˆš |  |
| gen beacon (arm64) |  |  |  | âˆš | âˆš |  |
| gen beacon (mips[el]) |  |  |  |  |  | â» |

å—é™è¯´æ˜:
* Linux: ç‰¹åˆ«è€æ—§çš„ç³»ç»Ÿå¯ä»¥é€‰æ‹©cnaä¸­çš„"Linux-GLIBC"é€‰é¡¹ï¼ˆ2010å¹´å·¦å³ï¼‰
* MacOS: æ–°ç³»ç»Ÿä»…æ”¯æŒ64ä½ç¨‹åº
* iOS: sandbox 
* Embedded: only *nix
* â» : åŠ è½½è¿˜åœ¨å®Œå–„ä¸­


# Install

ä¸‹è½½åŸºç¡€æ–‡ä»¶:

> 
* **CrossC2.cna**
* **genCrossC2** `CSè¿è¡Œç¯å¢ƒ`

1. æ‹·è´ **CrossC2.cna** ä¸ **genCrossC2** æ–‡ä»¶åˆ°CobaltStrike **æ ¹ç›®å½•** ä¸‹ (å¿…é¡»å¤„äº **åŒç›®å½•** )
2. é€‰æ‹©`Script Manager`ï¼Œæ·»åŠ `CrossC2.cna` (å¦‚æœæˆåŠŸå®‰è£…ï¼Œèœå•æ ä¼šå¤šå‡ºä¸€é¡¹ `CrossC2`)
3. ä¿®æ”¹`CrossC2.cna`è„šæœ¬ä¸­`genCrossC2`è·¯å¾„ä¸º**çœŸå®è·¯å¾„**

```
|  | Windows | Linux | MacOS | iOS | Android | Embedded |
| --- | --- | --- | --- | --- | --- | --- |
| Run Env (x86) |  | âˆš |  |  |  |  |
| Run Env (x64) |  | âˆš | âˆš |  |  |  |
| gen beacon (x86) |  | âˆš |  |  | âˆš |  |
| gen beacon (x64) |  | âˆš | âˆš |  |  |  |
| gen beacon (armv7) |  |  |  |   | âˆš |  |
| gen beacon (arm64) |  |  |  | âˆš | âˆš |  |
| gen beacon (mips[el]) |  |  |  |  |  | â» |

exec("/xxx/xxx/genCrossC2"... -> exec("/opt/cs/genCrossC2"...
```


# Usage

## teamserver

å› ä¸ºä¸€äº›åŸå› ï¼Œç›®å‰å¼ºåˆ¶åªæ”¯æŒHTTPS beacon
`åç»­å°†æ”¯æŒC2~~ProfileåŠ¨æ€è§£æ`

**å¤åˆ¶serverä¸Šcsç›®å½•ä¸‹çš„ `.cobaltstrike.beacon_keys`åˆ°æœ¬åœ°csç›®å½•ä¸‹**

## cnaæ’ä»¶æ–¹å¼ 

```
èœå•æ : CrossC2 -> CrossC2 Payload Generator -> genCrossC2

å¼¹å‡ºçš„å¯¹è¯æ¡†ä¸­å¯ä»¥é…ç½®:
1. æ“ä½œç³»ç»Ÿ
2. è¿è¡Œä½æ•°
3. Payloadç±»å‹(ç›®å‰ä»…æ”¯æŒStageless, Stagedæ­£åœ¨æ›´æ–°ä¸­)
4. ç”Ÿæˆæ–‡ä»¶ä¿å­˜è·¯å¾„

æœ€ç»ˆå°†ç”ŸæˆPayloadåˆ°æŒ‡å®šç›®å½•ä»¥åŠåˆ›å»ºä¾›wgetç­‰å·¥å…·ä½¿ç”¨çš„Scripted Web Delivery

```
![](media/15848885324084/15848895853537.jpg)


## ç›´æ¥è¿è¡Œåº•å±‚ç¨‹åº

é™¤è¿‡cna GUIç”Ÿæˆå¤–ï¼Œä¹Ÿå¯ä»¥ç›´æ¥è°ƒç”¨åº•å±‚ç¨‹åºç›´æ¥ç”Ÿæˆã€‚

```
[usage]: genCrossC2 [host] [port] [getURI] [postURI] [platform] [arch] [outputFileName]


-platform		'MacOS' / 'Linux'
-arch    		'x86' / 'x64'

[ex]:
	genCrossC2 127.0.0.1 4444 null null MacOS x64 ./CrossC2-test
```
![](media/15718834682843/15794546043572.jpg)


# å³å°†ä¸Šçº¿

1. ä¸°å¯Œçš„C2Profileæ”¯æŒ
2. Stagedç±»å‹Shellcodeç”Ÿæˆ
3. http-proxy (auth) & socks ä»£ç†å›è¿æ”¯æŒ
4. æµé‡ä¸­è½¬æ”¯æŒ 
5. node beacon? (å•ä¸ªèŠ‚ç‚¹å¼ï¼Œå¯è¿›è¡Œä¸ä¾é teamserveræ‰˜ç®¡å…¶ä»–beacon)

# Examples

## Mobile
![](media/15848885324084/15848892759774.jpg)

![](media/15848885324084/15848892902723.jpg)

## MacOS & Linux

![](media/15794884596715/15795001494711.jpg)
![](media/15824278372797/15824282351545.jpg)
![](media/15824278372797/15824282632072.jpg)


# ChangeLog

## release v0.1 : 

* æ”¯æŒ ç”Ÿæˆ Linux & MacOS beacon.

md5(genCrossC2.Linux) = f4c0cc85c7cdd096d2b7febedc037538

md5(genCrossC2.MacOS) = 79fff0505092fc2055824ed1289ce8f9

## release v0.2 : 

* -ä¿®å¤ Linux genCrossC2.Linux å´©æºƒçš„bug.
* -ä¿®å¤ å¤§æ–‡ä»¶ä¸Šä¼ æ—¶æœ«å°¾å­—èŠ‚å†™å…¥ä¸å…¨çš„bug.
* +æ”¯æŒ GUIçš„æ–‡ä»¶ç®¡ç†å™¨.

md5(genCrossC2.Linux) = 8256374d88c2149efc102aff7e90b3f9

md5(genCrossC2.MacOS) = 08fce0a5d964a091d8bf2344d7ab809e

## release v0.3 :

* +æ”¯æŒ è€ç³»ç»ŸLinuxä¸Šä½ç‰ˆæœ¬GLIBCçš„å…¼å®¹ (2010å¹´å·¦å³)

## release v0.4 :

* -å˜æ›´ shellå‘½ä»¤æ‰§è¡Œæ—¶é‡‡ç”¨åå°å¤šçº¿ç¨‹æ–¹å¼
* -å˜æ›´ shellå‘½ä»¤æ‰§è¡Œæ—¶é”™è¯¯è¾“å‡ºé‡å®šå‘åˆ°æ ‡å‡†è¾“å‡º
* +æ”¯æŒ å¢åŠ åå°æ–‡ä»¶ä¸‹è½½åŠŸèƒ½

md5(genCrossC2.Linux) = b2e34f721ec2543b6625e33c8c2935df

md5(genCrossC2.MacOS) = 4e38a9d9a3eeff309648afc02e2e7664




